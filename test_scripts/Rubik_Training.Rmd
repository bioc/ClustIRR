---
title: "Rubik Cube 2x2x2"
output: html_notebook
---

Just some tests to get fit in combinatorial stuff and solve something with 
graph theory

# Permutation with repetition

If we have $n$ elements to choose from that can be repeatedly combined to $k$
positions, than the formula for the number of combination is

$$n^k$$ 

```{r}
cat("n = 2, k = 3, 2*2*2 = 8 possible combinations")
expand.grid(0, 1)
```

```{r}
cat("n = 2, k = 3, 2*2*2 = 8 possible combinations")
expand.grid(rep(list(0:1), 3))
#expand.grid("1" = c(0,1), "2" = c(0,1), "3" = c(0,1)) # alternative way
```

Can be used for possible combinations of CDR3 for a sequence length.

Scientific notation can be turned on/off with 
options(scipen = 999) or options(scipen = 0).

```{r}
# no B, O, U, X or Z
aa <- c("A","C","D","E","F","G","H","I","K","L","M","N",
        "P","Q","R","S","T","V","W","Y") 

# turn off scientific notation
options(scipen = 999)

# turn on scientific notation
options(scipen = 0)

# number of positions
k <- 2

# n^k
length(aa)^k 

#expand.grid(rep(list(aa), n)) # alternative way
head(expand.grid("1" = aa, "2" = aa), 25)

# 1mer
# 20^1 = 20 - 2e+01
# twenty

# 2mer
# 20^2 = 400 - 4e+02
# 4 hundred

# 3mer
# 20^3 = 8.000 - 8e+03
# 8 thousand

# 4mers
# 20^4 = 160.000  - 1.6e+05
# 160 thousand

# 5mers
# 20^5 = 3.200.000 - 3.2e+06
# 3 million 200 thousand
# ≈ 0.87 × the number of arrangements of a 2×2×2 Rubik's cube (3.7e+06)

# 6mers
# 20^6 = 64.000.000 - 6.4e+07
# 64 million
# ≈ 0.64 × the largest number (number of angels) in the Bible (1e+08)

# 7mers
# 20^7 = 1.280.000.000 - 1.28e+09
# 1 billion 280 million
# ≈ 0.16 × the number of people alive today (≈ 7.8e+09)
# ≈ 13 × the largest number (number of angels) in the Bible (1e+08)

# 8mers
# 20^8 = 25.600.000.000 - 2.56e+10
# 25 billion 600 million
# ≈ 0.085 × the number of stars in our galaxy (≈ 3e+11)
# ≈ 0.24 × the number of people who have ever lived (≈ 1.1e+11)
# ≈ 3.3 × the number of people alive today (≈ 7.8e+09)

# 9mers
# 20^9 = 512.000.000.000 - 5.12e+11
# 512 billion
# ≈ 0.026 × the number of red blood cells in the human body (≈ 2e+13)
# ≈ 1.7 × the number of stars in our galaxy (≈ 3e+11)
# ≈ 4.7 × the number of people who have ever lived (≈ 1.1e+11)

# 10mers
# 20^10 = 10.240.000.000.000 - 1.024e+13
# 10 trillion 240 billion
# ≈ 34 × the number of stars in our galaxy (≈ 3e+11)

# 11mers
# 20^11 = 204.800.000.000.000 - 2.048e+14
# 204 trillion 800 billion
# ≈ 10 × the number of red blood cells in the human body (≈ 2e+13)

# 12mers
# 20^12 = 4.096.000.000.000.000 - 4.096e+15
# 4 quadrillion 96 trillion

# 13mers
# 20^13 = 81.920.000.000.000.000 - 8.192e+16
# 81 quadrillion 920 trillion
# ≈ 0.0019 × the number of arrangements of a 3×3×3 Rubik's cube (4.3e+19)

# 14mers
# 20^14 = 1.638.400.000.000.000.000 - 1.6384e+18
# 1 quintillion 638 quadrillion 400 trillion
# ≈ 0.038 × the number of arrangements of a 3×3×3 Rubik's cube (4.3e+19)

# 15mers
# 20^15 = 32.768.000.000.000.000.000 - 3.2768e+19
# 32 quintillion 768 quadrillion
# ≈ 0.76 × the number of arrangements of a 3×3×3 Rubik's cube (4.3e+19)

# 16mers
# 20^16 = 655.360.000.000.000.000.000 - 6.5536e+20 
# 655 quintillion 360 quadrillion
# ≈ 15 × the number of arrangements of a 3×3×3 Rubik's cube (4.3e+19)

# 17mers
# 20^17 = 13.107.200.000.000.000.000.000 - 1.31072e+22
# 13 sextillion 107 quintillion 200 quadrillion
# ≈ 300 × the number of arrangements of a 3×3×3 Rubik's cube (4.3e+19)

# 18mers
# 20^18 = 262.144.000.000.000.000.000.000 - 2.62144e+23
# 262 sextillion 144 quintillion
# ≈ (0.26 to 2600) × grains of sand on earth (≈ 1e+20 to 1e+24)

# 19mers
# 5 septillion 242 sextillion 880 quintillion
# 20^19 = 5.242.880.000.000.000.000.000.000 - 5.24288e+24

# 20mers
# 104 septillion 857 sextillion 600 quintillion
# 20^20 = 104.857.600.000.000.000.000.000.000 - 1.048576e+26

```



# Permutation without repetition

Draw $k$ out of $n$ possible selections without putting the drawn back.

Binomial coefficient: 

$${n \choose k} = \frac{n!}{k!*(n-k)!}$$
```{r}

```


```{r}
# lottery, 49 over 6, 6 out of 49
# combn(1:49, 6) # takes some time
# ncol(combn(1:49, 6)) # 13.983.816

# 4 over 4, 4 out of 4
combn(letters[1:4], 4)
ncol(combn(letters[1:4], 4)) # 1

# 4 over 3, 3 out of 4
combn(letters[1:4], 3)
ncol(combn(letters[1:4], 3)) # 4

# 4 over 2, 2 out of 4
combn(letters[1:4], 2)
ncol(combn(letters[1:4], 2)) # 6

# 4 over 2, 1 out of 4
combn(letters[1:4], 1)
ncol(combn(letters[1:4], 1)) # 4
```
# Permutation of all elements without repetition

Possible ways to sort $n$ unique elements and always use all of 
them. For example, ways to organize four pearls on chain: $4! = 4*3*2*1 = 24$.

Easy formula $n!$, 

```{r}
# recursive function
perm <- function(v) {
  
  # number of elements
  n <- length(v)
  
  # base case
  if (n == 1) {
    return(as.data.frame(v))
  }
  
  else {
    
    X <- NULL
    
    for (i in 1:n) {
      X <- rbind(X, cbind(v[i], perm(v[-i])))
    }
    
    return(X)
  }
}

perm(letters[1:3])

```


# Rubiks Cube

We will try to analyse a rubiks cube.

We will fix one cube for orientation.

Cubes can be rotate against each other.
There are three possible orientations for each cube.

The number of configurations should be 3.700.000 according to Wolfram Alpha.

$|𝐺|/24 = 8!⋅3^7 / 24 = 3 674 160$

24 = rotation group

```{r}
# 6 colors
colors <- c("blue",   # b
            "green",  # g  
            "red",    # r
            "orange", # o
            "white",  # w
            "yellow") # y

# there are 8 cubes in total with 3 colors each
cubes <- c("b_r_w",
           "g_r_w",
           "b_o_w",
           "g_o_w",
           "b_g_r",
           "g_r_y",
           "b_o_y",
           "g_o_y")

# There are 8 possible positions where the cubes can be (one is fixed)
positions <- c("ftl", # front  top     left
               "ftr", # front  top     right
               "fbl", # front  bottom  left
               "fbr", # front  bottom  right
               "rtl", # rear   top     left
               "rtr", # rear   top     right
               "rbl", # rear   bottom  left
               "rbr") # rear   bottom  right

# Fix "b_r_w" at "ftl" and permutate the other 7 without repetition
configurations <- data.frame("b_r_w", perm(cubes[2:8]))
names(configurations) <- positions

nrow(configurations) # 5040 possible configuration if 1 fixed and no rotations

# with rotations, we actually get much more possibilites
# each cube can be in 3 orientations at each position
# so 3! = 6 possibilities per position, so 6*7 = 42 positions
# we will fix "b_r_w" to the front top left of the cube
cubes_orientated <- c("g_r_w", "g_w_r", "r_g_w", "r_w_g", "w_g_r", "w_r_g",
                      "b_o_w", "b_w_o", "o_b_w", "o_w_b", "w_b_o", "w_o_b",
                      "g_o_w", "g_w_o", "o_g_w", "o_w_g", "w_g_o", "w_o_g",
                      "b_g_r", "b_r_g", "g_b_r", "g_r_b", "r_b_g", "r_g_b",
                      "g_r_y", "g_y_r", "r_g_y", "r_y_g", "y_g_r", "y_r_g",
                      "b_o_y", "b_y_o", "o_b_y", "o_y_b", "y_b_o", "y_o_b",
                      "g_o_y", "g_y_o", "o_g_y", "o_y_g", "y_g_o", "y_o_g")



# Can't be combinations of all orientations, because every cube can be there 
# only once
factorial(42) 
# 1.405.006.117.752.879.788.779.635.797.590.784.832.178.972.610.527.232
# Would take forever to compute
# configurations_oriented <- data.frame("b_r_w", perm(cubes_orientated))
# names(configurations_oriented) <- positions

# Let's look at the first row
configurations[1,]

# At every position but the first there can be 6 instead of 1 orientations

```

So now we have 5400 configurations, that will be our **nodes**.
The edges will be the possible transformations.
We will not take into account the rotations, just to try it.

There are three possible ways to rotate the cube, if we keep one cube fixed to
the front top left:

* X - rotate *fbl*, *fbr*, *rbr* and *rbl* left or right

* Y - rotate *ftr*, *fbr*, *rtr* and *rbr* up or down

* Z - rotate *rtr*, *rbr*, *rtl* and *rbl* left or right

```{r}
# X - rotate *fbl*, *fbr*, *rbr* and *rbl* left or right
# rotation in x direction
x <- function(df, n = 1, left = FALSE){
  
  # rotate n times
  for (i in 1:n){
    
    # select the last column as starting point
    s <- df[nrow(df),]
    
    # rotate the columns to the right direction (default)
    if (!left) {
      fbl_t <- s$fbl
      s$fbl <- s$rbl
      s$rbl <- s$rbr
      s$rbr <- s$fbr
      s$fbr <- fbl_t
    }
    
    # rotate the columns to the left direction
    else {
      fbl_t <- s$fbl
      s$fbl <- s$fbr
      s$fbr <- s$rbr
      s$rbr <- s$rbl
      s$rbl <- fbl_t
    }
    df <- rbind(df, s)
  }
  rownames(df) = NULL
  
  return(df)
}

# * Y - rotate *ftr*, *fbr*, *rtr* and *rbr* up or down
# rotation in y direction
y <- function(df, n = 1, down = FALSE){
  
  # rotate n times
  for (i in 1:n){
    
    # select the last column as starting point
    s <- df[nrow(df),]
    
    # rotate the columns to upwards (default)
    if (!down) {
      ftr_t <- s$ftr
      s$ftr <- s$fbr
      s$fbr <- s$rbr
      s$rbr <- s$rtr
      s$rtr <- ftr_t
    }
    
    # rotate the columns downwards
    else {
      ftr_t <- s$ftr
      s$ftr <- s$rtr
      s$rtr <- s$rbr
      s$rbr <- s$fbr
      s$fbr <- ftr_t
    }
    df <- rbind(df, s)
  }
  rownames(df) = NULL
  
  return(df)
}

# Z - rotate *rtr*, *rbr*, *rtl* and *rbl* left or right
# rotation in z direction
z <- function(df, n = 1, rear_left = FALSE){
  
  # rotate n times
  for (i in 1:n){
    
    # select the last column as starting point
    s <- df[nrow(df),]
    
    # rotate the rear columns to the right (default)
    if (!rear_left) {
      rtr_t <- s$rtr
      s$rtr <- s$rtl
      s$rtl <- s$rbl
      s$rbl <- s$rbr
      s$rbr <- rtr_t
    }
    
    # rotate the rear columns to the left
    else {
      rtr_t <- s$rtr
      s$rtr <- s$rbr
      s$rbr <- s$rbl
      s$rbl <- s$rtl
      s$rtl <- rtr_t
    }
    df <- rbind(df, s)
  }
  rownames(df) = NULL
  
  return(df)
}

```

# Rotation experiments

Note each combination of rotation and it's effect, starting with the "perfect"
constellation.

```{r}
# Let's look at the first row as starting point
# we will add one line for each rotation
s <- configurations[1,]

s <- x(s, 4) # rotate right four times
s <- x(s, 4, T) # rotate left four times

# same with y
s <- y(s, 4, T)
s <- y(s, 4)

# same with z
s <- z(s, 4, T)
s <- z(s, 4)

for(i in 1:4){
  s <- x(s)
  s <- y(s, 4)
  s <- z(s, 4)
}

for(i in 1:4){
  s <- y(s)
  s <- x(s, 4)
  s <- z(s, 4)
}

for(i in 1:4){
  s <- z(s)
  s <- x(s, 4)
  s <- y(s, 4)
}


# reduce to unique rows
s <- unique(s)
rownames(s) = NULL


```





